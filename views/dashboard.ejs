<% layout('layout/basicLayout') -%>

<% block('css', '<link rel="stylesheet" href="/static/css/dashboard.css">') -%>

<% if (user.provider.providerType === 'email' && !user.profile.isEmailVerified) { %>
  <h2 class="visually-hidden"><%=title%></h2>
  <div class="text-center">
    <p>
      You have not verified your email.
    </p>
    <form id="emailVerificationForm" action="/api/users/sendEmailVerificationForEmail" method="POST">
      <input type="hidden" name="email" class="form-control" value="<%= user.profile.email || '' %>" />
      <button
        type="submit"
        class="btn btn-primary d-inline-flex justify-content-center align-items-center"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          fill="currentColor"
          class="bi bi-envelope me-2"
          viewBox="0 0 16 16"
        >
          <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
        </svg>
        <span>
          Resend Email Verification
        </span>
      </button>
    </form>
  </div>
<% } else { %>
  <h2 class="visually-hidden"><%=title%></h2>

  <% if (user.provider.providerType === 'email') { %>
    <h3>Reset Password</h3>
    <div class="mb-5">
      <a class="reset-password-button" href="javascript: void(0)">
        Reset Password
      </a>
    </div>
  <% } %>

  <h3>User Statistics</h3>

  <div class="card-group mb-5">
    <div class="card">
      <div class="card-body d-flex flex-column align-items-center justify-content-between">
        <h4 class="card-title h5">Total number of users who have signed up.</h4>
        <div id="userTotal" class="card-text mt-3 text-center">
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-body d-flex flex-column align-items-center justify-content-between">
        <h4 class="card-title h5">Total number of users with active sessions today.</h4>
        <div id="todayActiveUserTotal" class="card-text mt-3 text-center">
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-body d-flex flex-column align-items-center justify-content-between">
        <h4 class="card-title h5">Average number of active session users in the last 7 days rolling.</h4>
        <div id="lastSevenDayActiveUserAverage" class="card-text mt-3 text-center">
        </div>
      </div>
    </div>
  </div>

  <div class="table-responsive">
    <table id="userListTable" class="table table-bordered table-hover caption-top">
      <caption>
        <h3>Users</h3>
      </caption>
      <thead class="table-light text-center">
        <tr>
          <th scope="col">ID</th>
          <th scope="col">Number Of Logon</th>
          <th scope="col">Last Session Timestamp (milliseconds)</th>
          <th scope="col">Sign Up Timestamp (milliseconds)</th>
        </tr>
      </thead>
      <tbody class="text-center">
        <tr>
          <td colspan="4">
            Loading...
          </td>
        </tr>
      </tbody>
      <tfoot>
        <tr>
          <td colspan="4">
            <nav aria-label="user list navigation">
              <ul id="userListPagination" class="pagination justify-content-center mb-0">
                <li class="previous-btn page-item disabled"><a class="page-link" href="javascript: void(0)">Previous</a></li>
                <li class="page-item active"><a class="page-link" href="javascript: void(0)">1</a></li>
                <li class="next-btn page-item disabled"><a class="page-link" href="javascript: void(0)">Next</a></li>
              </ul>
            </nav>
          </td>
        </tr>
      </tfoot>
    </table>
  </div>
<% } %>

<input type="hidden" id="userId" value="<%= user && user.id %>" />
<% block('script', '<script src="/static/js/dashboard.js"></script>') -%>
